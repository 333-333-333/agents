meta {
  name: Send Email Notification
  type: http
  seq: 1
}

post {
  url: {{baseUrl}}/api/v1/notifications/send
  body: json
  auth: none
}

headers {
  Content-Type: application/json
}

body:json {
  {
    "channel": "email",
    "recipient": "user@example.com",
    "subject": "Bienvenido a Bastet",
    "content": "Tu cuenta ha sido creada exitosamente."
  }
}

tests {
  test("status is 200", function() {
    expect(res.getStatus()).to.equal(200);
  });

  test("response has data", function() {
    const body = res.getBody();
    expect(body.data).to.not.be.undefined;
  });

  test("notification has ID", function() {
    const data = res.getBody().data;
    expect(data.id).to.be.a('string');
    expect(data.id.length).to.be.greaterThan(0);
  });

  test("notification status is sent", function() {
    const data = res.getBody().data;
    expect(data.status).to.equal('sent');
  });

  test("channel is email", function() {
    const data = res.getBody().data;
    expect(data.channel).to.equal('email');
  });

  test("sent_at is present", function() {
    const data = res.getBody().data;
    expect(data.sent_at).to.not.be.null;
  });
}
